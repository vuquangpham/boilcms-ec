<%
// boolean for checking edit or add new post
const isEditPost = actionType === 'edit';

// validate selected value on select
const isSelectedValue = (name, value) => {
    if (!isEditPost) return null;
    return data[name] === value ? 'selected' : null;
};

// get value from data
const getValueFromData = (name, property = '') => {
    if (!isEditPost) return '';
    return property ? data[name][property] : data[name];
};

// get key value from object data
const getKeyValueOb = (obj, index, key = 'key') => {
    if(!isEditPost) return '';
    return key === 'key' ? Object.keys(obj)[index] : Object.values(obj)[index]
}

%>

<div data-custom-title>
    <span>Add new product</span>
</div>

<div class="container" data-product-detail data-product-wrapper>
    <form action="?post_type=product&method=post&action=<%= actionType %>"
          method="post"
          class="detail-product">
        <h1><%= actionType %></h1>

        <!-- Product detail -->
        <div class="products-detail fl-grid">
            <div class="products-detail__col products-detail__col--left">
                <div class="products-detail__information">

                    <div class="products-detail__name">
                        <label for="name" class="hidden">Add Name</label>
                        <input type="text" placeholder="Name" id="name" name="name" required
                               class="w100" value="<%= getValueFromData('name') %>">
                    </div>

                    <div class="products-detail__description">
                        <label for="description" class="hidden">Product Description</label>
                        <textarea type="text" placeholder="Description" id="description" name="description" required
                                  class="w100"><%= getValueFromData('description') %></textarea>
                    </div>
                </div>

                <div class="products-detail__dropdown fl-center-v">
                    <label for="product-type">Product type</label>
                    <select data-easy-select name="productType" id="product-type" data-productType-value>
                        <option <%= isSelectedValue('productType', 'simple'); %> value="simple">Simple Product
                        </option>
                        <option <%= isSelectedValue('productType', 'variable'); %> value="variable">Variable Product
                        </option>
                    </select>
                </div>

                <div class="products-detail__information">

                    <div class="products-detail__inventory">
                        <label for="inventory">Inventory</label>
                        <input type="text" placeholder="Inventory" id="inventory" name="inventory"
                               class="w100" value="<%= getValueFromData('inventory') %>">
                    </div>
                </div>

                <div>

                    <!-- Simple product detail-->
                    <div class="products-detail__information" data-simple-product>
                        <div class="products-detail__price">
                            <label for="price">Price ($)</label>
                            <input type="text" placeholder="Price" id="price" name="price"
                                   class="w100" value="<%= getValueFromData('price') %>">
                        </div>

                        <div class="products-detail__sale-price">
                            <label for="sale-price">Sale Price ($)</label>
                            <input type="text" placeholder="Sale price" id="sale-price" name="salePrice"
                                   class="w100" value="<%= getValueFromData('salePrice') %>">
                        </div>

                    </div>

                    <!-- Variable product detail -->
                    <div data-variable-product style="display: none">
                        <div>
                            <button type="button" data-add-new-attribute>Add new</button>
                        </div>

                        <!-- Attribute detail for variable product -->
                        <div data-attribute-number="0">
                            <div data-taxonomy>
                                <div>
                                    <div data-attribute-name>New attribute</div>
                                    <button type="button" data-delete-attribute>Remove</button>
                                </div>

                                <div data-attribute-details>
                                    <div class="products-detail__attribute-name" data-attribute-product-name>
                                        <label for="attribute-name">Name</label>
                                        <input type="text" placeholder="Attribute name" id="attribute-name"
                                               name="attributeName[0]"
                                               class="w100" >
                                    </div>

                                    <div class="products-detail__attribute-value" data-attribute-product-value>
                                        <label for="attribute-value">Values</label>
                                        <textarea type="text"
                                                  placeholder="Enter some descriptive text. Use “|” to separate different values."
                                                  id="attribute-value" name="attributeValue[0]"
                                                  class="w100"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <!-- Save attribute button -->
                    <div>
                        <button type="button" data-save-attribute>Save</button>
                    </div>

                    <!-- Variations for variable product -->
                    <div data-variation-product style="display: none">

                        <div>
                            <button type="button" data-add-new-variation>Add manually</button>
                        </div>

                    </div>

                </div>

            </div>

            <div>
                <label for="content">JSON</label>
                <textarea data-product-json id="content"></textarea>
            </div>

            <div class="products-detail__col products-detail__col--right">
                <div class="products-detail__dropdown fl-center-v">
                    <label for="visibility">Visibility</label>
                    <select data-easy-select name="visibility" id="visibility">
                        <option <%= isSelectedValue('visibility', 'public'); %> value="public">Public
                        </option>
                        <option <%= isSelectedValue('visibility', 'private'); %> value="private">Private
                        </option>
                    </select>
                </div>

                <button type="submit" class="btn_primary">Publish</button>
            </div>
        </div>

    </form>
</div>